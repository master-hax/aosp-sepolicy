{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "aeca4a0f_3d80009b",
        "filename": "private/seapp_contexts",
        "patchSetId": 3
      },
      "lineNbr": 182,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-02-14T13:05:22Z",
      "side": 1,
      "message": "do we also need an entry for com.google.android.systemui ?",
      "range": {
        "startLine": 182,
        "startChar": 0,
        "endLine": 182,
        "endChar": 105
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e617589e_4ba794eb",
        "filename": "private/seapp_contexts",
        "patchSetId": 3
      },
      "lineNbr": 182,
      "author": {
        "id": 1938075
      },
      "writtenOn": "2024-02-15T05:53:36Z",
      "side": 1,
      "message": "I don\u0027t think so. The reason for this, is that I have been using a pixel (which I believe relies upon this package, not just com.android.systemui) to test my changes, and it has not been breaking.",
      "parentUuid": "aeca4a0f_3d80009b",
      "range": {
        "startLine": 182,
        "startChar": 0,
        "endLine": 182,
        "endChar": 105
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8091ff79_35fc1f05",
        "filename": "private/system_suspend.te",
        "patchSetId": 3
      },
      "lineNbr": 56,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-02-14T13:05:22Z",
      "side": 1,
      "message": "why is this needed when it wasn\u0027t previously for platform_app?",
      "range": {
        "startLine": 56,
        "startChar": 5,
        "endLine": 56,
        "endChar": 18
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "edfa55d2_faa7267d",
        "filename": "private/system_suspend.te",
        "patchSetId": 3
      },
      "lineNbr": 56,
      "author": {
        "id": 1938075
      },
      "writtenOn": "2024-02-15T05:53:36Z",
      "side": 1,
      "message": "It is actually not needed in the newest revision.",
      "parentUuid": "8091ff79_35fc1f05",
      "range": {
        "startLine": 56,
        "startChar": 5,
        "endLine": 56,
        "endChar": 18
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1525fd7c_b0daa5d2",
        "filename": "private/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 8,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-02-14T13:05:22Z",
      "side": 1,
      "message": "Can these permissions be removed from platform_app?",
      "range": {
        "startLine": 5,
        "startChar": 0,
        "endLine": 8,
        "endChar": 76
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "da97f442_ab21135d",
        "filename": "private/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 8,
      "author": {
        "id": 1938075
      },
      "writtenOn": "2024-02-15T05:53:36Z",
      "side": 1,
      "message": "Per our conversation today, this is no longer applicable for the short term future.",
      "parentUuid": "1525fd7c_b0daa5d2",
      "range": {
        "startLine": 5,
        "startChar": 0,
        "endLine": 8,
        "endChar": 76
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "913080b8_5ac16033",
        "filename": "private/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 12,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-02-14T13:05:22Z",
      "side": 1,
      "message": "This aligns with how traceur_app does this, but not with how system_server does it (aosp/2958867). Perhaps Primiano can chime in on how he\u0027d prefer this to work.",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 53
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "93fe8f49_d8b27f4f",
        "filename": "private/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 12,
      "author": {
        "id": 1040443
      },
      "writtenOn": "2024-02-14T16:22:39Z",
      "side": 1,
      "message": "Yep, see my other comment, I\u0027m advocating for domain_auto_trans here as well (Which is how syssrv does it).\nHowever, compared to syssrv, I don\u0027t think sysui needs any permission to readback the data, as that will automatically be attached by traced to the bugreport.\n\nSee again the comment+question I wrote on Jan 26 about the fact that I don\u0027t think you need trace readback permission (or if you do, I\u0027d like to understand why)\n\nhttps://android-review.git.corp.google.com/c/platform/system/sepolicy/+/2924820/comments/241b6925_2efd32d8",
      "parentUuid": "913080b8_5ac16033",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 53
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "43563e3f_6c357cf1",
        "filename": "private/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 12,
      "author": {
        "id": 1938075
      },
      "writtenOn": "2024-02-15T05:53:36Z",
      "side": 1,
      "message": "Please see the newest revision. Does domain_auto_trans still apply since we are just giving platform_app permissions in userdebug/eng builds?",
      "parentUuid": "93fe8f49_d8b27f4f",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 53
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b740dd63_de79de60",
        "filename": "private/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 12,
      "author": {
        "id": 1040443
      },
      "writtenOn": "2024-02-15T12:41:16Z",
      "side": 1,
      "message": "Yes. Once again. Doesn\u0027t matter where it comes from. If you want to exec perfetto, do that from its own domain, so we our teams doesn\u0027t have to maintain N sources that execute perfetto",
      "parentUuid": "43563e3f_6c357cf1",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 53
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b2a96bc7_e8c3896a",
        "filename": "private/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 12,
      "author": {
        "id": 1938075
      },
      "writtenOn": "2024-02-28T22:34:27Z",
      "side": 1,
      "message": "I am resolving this comment because the following is copy/pasted from my other reply,and is the same answer:\n\n\"\nI think we should keep this here, and not use domain_auto_trans. My reasoning is:\n1. This is a temporary solution, so we don\u0027t need to worry about upkeeping N sources that execute perfetto for very long. This line will be removed as soon as we get a long-term solution.\n2. If we use a domain_auto_trans, perfetto needs to be given permissions to trace_data_file, in addition to giving platform_app permissions to trace_data_file. The perfetto command line is writing its output to a file in /data/local/traces, and the system_ui process is sharing it, so both need permissions.\n\n    One idea to get around this issue has been given here: https://docs.google.com/document/d/1_Vb2zZsXRMkJEaMfgOEcg4VzpdoF0HydvLjfRO9Q5jg/edit?tab\u003dt.0.\n\n    That doesn\u0027t make things better security wise for platform_apps though, because SystemUI still needs to share other files within the /data/local/trace directory, so it still needs the same new permissions to trace_data_file and wm_trace_data_file that are already listed in this CL. If anything, it would need more permissions to that new file type, and we would have to make significant code changes to packages/apps/Traceur to implement conditional logic for SystemUI vs for Traceur. For a temporary solution, I think it is simpler and less risky to use the currently proposed solution.\n\n    Also, if we do go with the long-term solution of using a Traceur-Perfetto/Winscope service to start/stop traces, then this idea would make that code change more complicated.\n\n3. Also, if y\u0027all really want to use domain_auto_trans, I put together a CL (aosp/2982893) with the minimal number of permissions that would need to be given to perfetto to allow that to happen without breaking the new feature. It requires that BOTH perfetto and platform_app have permissions to trace_data_file and wm_trace_data_file. I would be happy going forward with that solution, but I personally like the solution here better.\n\"",
      "parentUuid": "b740dd63_de79de60",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 12,
        "endChar": 53
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "92d6474b_c829de69",
        "filename": "private/traced.te",
        "patchSetId": 3
      },
      "lineNbr": 123,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-02-14T13:05:22Z",
      "side": 1,
      "message": "Do you actually need access to this? I don\u0027t think so. I think this is the result of your overly permissive allow rule in system_ui_app.te.",
      "range": {
        "startLine": 123,
        "startChar": 3,
        "endLine": 123,
        "endChar": 16
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c4888142_516db300",
        "filename": "private/traced.te",
        "patchSetId": 3
      },
      "lineNbr": 123,
      "author": {
        "id": 1938075
      },
      "writtenOn": "2024-02-15T05:53:36Z",
      "side": 1,
      "message": "I do need actual access to this. The process crashes otherwise.",
      "parentUuid": "92d6474b_c829de69",
      "range": {
        "startLine": 123,
        "startChar": 3,
        "endLine": 123,
        "endChar": 16
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "649a29ae_f7c95314",
        "filename": "public/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 3,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-02-14T13:05:22Z",
      "side": 1,
      "message": "Why is this necessary?",
      "range": {
        "startLine": 3,
        "startChar": 0,
        "endLine": 3,
        "endChar": 56
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9f5b31f4_066ed895",
        "filename": "public/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 3,
      "author": {
        "id": 1938075
      },
      "writtenOn": "2024-02-15T05:53:36Z",
      "side": 1,
      "message": "Per our conversation earlier, this will be necessary, in a modified version, once we separate com.android.systemui into it\u0027s own SELinux context, but it won\u0027t be applicable to the short-term fix of just giving platform_app permissions in userdebug/eng builds.",
      "parentUuid": "649a29ae_f7c95314",
      "range": {
        "startLine": 3,
        "startChar": 0,
        "endLine": 3,
        "endChar": 56
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8deebe25_17d05010",
        "filename": "public/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 6,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-02-14T13:05:22Z",
      "side": 1,
      "message": "This isn\u0027t the right approach. Instead, list the services that you need access to.",
      "range": {
        "startLine": 6,
        "startChar": 2,
        "endLine": 6,
        "endChar": 22
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "209a47ed_dec98bb7",
        "filename": "public/system_ui_app.te",
        "patchSetId": 3
      },
      "lineNbr": 6,
      "author": {
        "id": 1938075
      },
      "writtenOn": "2024-02-15T05:53:36Z",
      "side": 1,
      "message": "When we create an SELinux context for SystemUI, we will replace this with something more specific.",
      "parentUuid": "8deebe25_17d05010",
      "range": {
        "startLine": 6,
        "startChar": 2,
        "endLine": 6,
        "endChar": 22
      },
      "revId": "e7ada175b8bf7756f73692f532d46aef30c07dda",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}