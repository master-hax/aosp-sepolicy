{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "3da3dfba_6c5f8484",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2024-09-05T00:22:12Z",
      "side": 1,
      "message": "in this CL, nobody has access to this. which process would you want to give access to this?",
      "range": {
        "startLine": 13,
        "startChar": 18,
        "endLine": 13,
        "endChar": 52
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab60d6fb_54b5a58a",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-09-05T00:25:18Z",
      "side": 1,
      "message": "I think this is generally okay - we actually want to add as many public types as possible for standard things, so that we don\u0027t run into the Treble file context labeling problem later. See b/361985697 comment #3 and later for a conversation we\u0027re having about this recently.",
      "parentUuid": "3da3dfba_6c5f8484",
      "range": {
        "startLine": 13,
        "startChar": 18,
        "endLine": 13,
        "endChar": 52
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7ae2ae2_5fe9df5e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2024-09-05T00:29:34Z",
      "side": 1,
      "message": "right, but we have to be careful because there can be existing processes (not only in AOSP, but also in partner devices) which have been accessing these files by using the original label. apexd is an example in this case. see my other comment.",
      "parentUuid": "ab60d6fb_54b5a58a",
      "range": {
        "startLine": 13,
        "startChar": 18,
        "endLine": 13,
        "endChar": 52
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "89aa22d4_add1c539",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-09-05T00:59:12Z",
      "side": 1,
      "message": "See my response there as well because I think it means we must be missing CTS coverage ðŸ˜Š. We should be able to add a compat mapping rule to handle this case.\n\nb/361985697 is about the other problem (file_context conflict).",
      "parentUuid": "e7ae2ae2_5fe9df5e",
      "range": {
        "startLine": 13,
        "startChar": 18,
        "endLine": 13,
        "endChar": 52
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "57ece29b_e9b2508f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2024-09-05T00:22:12Z",
      "side": 1,
      "message": "The description in the bug is very weak. Could you explain how this relates to car_generic?",
      "range": {
        "startLine": 17,
        "startChar": 5,
        "endLine": 17,
        "endChar": 14
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "879aa382_c416706e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 17,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2024-09-05T01:08:44Z",
      "side": 1,
      "message": "We want to allow a system setup script in car_generic system partition to access nsfs partition. So we need to add an allow rule and define nsfs. However, if we use goldfish, then there will be duplicate definition of nsfs. So we have to move to the definition to generic system. See ag/28999864",
      "parentUuid": "57ece29b_e9b2508f",
      "range": {
        "startLine": 17,
        "startChar": 5,
        "endLine": 17,
        "endChar": 14
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "839800fb_6ab20d20",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-09-04T19:58:27Z",
      "side": 1,
      "message": "lgtm, can you fix the merge conflict/presubmit errors?\n\nAre you sure no old devices would define this as well?",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3ddb602b_581185cb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2024-09-04T20:04:13Z",
      "side": 1,
      "message": "I am actually not sure how to add the version guard. According to https://android-review.git.corp.google.com/c/platform/system/sepolicy/+/3050544, I should add version guard. But then nsfs will not be defined in system until 202504. Then how would car system policy able to use nsfs?\n\nI tried defining nsfs in car system policy, but that will cause duplicate definition between car system policy and goldfish policy (since goldfish also defines nsfs).",
      "parentUuid": "839800fb_6ab20d20",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d7d13b9f_b3c5892f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2024-09-04T20:08:00Z",
      "side": 1,
      "message": "I searched internally and only goldfish (and sdv) has defined nsfs.",
      "parentUuid": "3ddb602b_581185cb",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2fb711d4_3ed5f06a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-09-04T20:20:45Z",
      "side": 1,
      "message": "does the type need to be \u0027public\u0027? can it be private?",
      "parentUuid": "d7d13b9f_b3c5892f",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e9332022_eb7f850d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2024-09-04T20:22:00Z",
      "side": 1,
      "message": "It is used by goldfish vendor: device/generic/goldfish/sepolicy/vendor/goldfish_setup.te\n\nSo i assume it has to be public?",
      "parentUuid": "2fb711d4_3ed5f06a",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d5da3f60_924e550a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-09-04T21:51:22Z",
      "side": 1,
      "message": "I think `allow dumpstate nsfs:file getattr;` could be moved to system there as well. Do we know why this is used?",
      "parentUuid": "e9332022_eb7f850d",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ffb63441_2c8d3311",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2024-09-04T21:57:05Z",
      "side": 1,
      "message": "`allow goldfish_setup nsfs:file r_file_perms;` is in goldfish_setup.te which is device specific. I do not know why goldfish needs this though. It was there before.",
      "parentUuid": "d5da3f60_924e550a",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "214bf125_b174160a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2024-09-05T00:22:12Z",
      "side": 1,
      "message": "`/proc/self/ns/mnt` is used by apexd. This labeling shouldn\u0027t make apexd loose access to the file. Please add appropriate allow rules.\n\nhttps://cs.android.com/search?q\u003dproc%5C%2Fself%5C%2Fns%20-f:external%20-f:prebuilts\u0026ss\u003dandroid%2Fplatform%2Fsuperproject%2Fmain",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bc0bd683_9a3ab163",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-09-05T00:22:59Z",
      "side": 1,
      "message": "Does that mean that apexd is broken on goldfish? it should have failed some CTS?",
      "parentUuid": "214bf125_b174160a",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "379abfc9_73b43cea",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-09-05T00:25:18Z",
      "side": 1,
      "message": "It would be good to know this, but yeah, seems like we would need to be public.\n\nHowever, introducing a new public type that used to be a vendor type is very difficult right now. b/361985697 is discussing a path forward, but it may be a few weeks, so if you can fully understand the goldfish need first, that may help!",
      "parentUuid": "ffb63441_2c8d3311",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5fb42f5_d3f713b4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2024-09-05T01:05:29Z",
      "side": 1,
      "message": "I just moved the nsfs definition from goldfish to system. Why would it cause apexd to loose access to anything?",
      "parentUuid": "bc0bd683_9a3ab163",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4a04aaea_3e2fe9d6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2024-09-05T01:19:11Z",
      "side": 1,
      "message": "Yes, if apexd has access to /proc/self/ before, it no longer has access to nsfs now, since this is carved out.\n\nOn goldfish, apexd should already not have access to nsfs (or this is fixed another way), so there is an open question there.",
      "parentUuid": "a5fb42f5_d3f713b4",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "83e42a29_cc77e1ab",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2024-09-05T01:24:10Z",
      "side": 1,
      "message": "I even tried a different name but again it does not allow two genfscon rule that all claims root nsfs with different name.",
      "parentUuid": "379abfc9_73b43cea",
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1d27397d_eb05ed0d",
        "filename": "public/file.te",
        "patchSetId": 2
      },
      "lineNbr": 204,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2024-09-05T01:18:01Z",
      "side": 1,
      "message": "You need to guard new public types with board API level macros.\n\nIn `public/file.te`,\n\n```\nstarting_at_board_api(202504, `type nsfs, fs_type;\u0027)\n```\n\nIn `private/file.te`,\n\n```\nuntil_board_api(202504, `type nsfs, fs_type;\u0027)\n```\n\nThis also means that vendor sepolicy (including goldfish vendor) won\u0027t be able to refer to new public types until 25Q2. You may want to guard lines removed in aosp/3255697 with `until_board_api(202504, ...)`.",
      "range": {
        "startLine": 204,
        "startChar": 0,
        "endLine": 204,
        "endChar": 19
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "289f5e12_a1375739",
        "filename": "public/file.te",
        "patchSetId": 2
      },
      "lineNbr": 204,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2024-09-05T01:22:33Z",
      "side": 1,
      "message": "I understand.\n\nHowever, we want to allow a system setup script to access nsfs before 2025Q2. If goldfish vendor is still defining type nsfs before 2025Q2, then our car_generic system cannot define nsfs before 2025 Q2, thus cannot add allow rule (because car_generic system might build with other devices, e.g. cf)",
      "parentUuid": "1d27397d_eb05ed0d",
      "range": {
        "startLine": 204,
        "startChar": 0,
        "endLine": 204,
        "endChar": 19
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67da8455_26e3b12e",
        "filename": "public/file.te",
        "patchSetId": 2
      },
      "lineNbr": 204,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2024-09-05T01:34:21Z",
      "side": 1,
      "message": "202404 public sepolicy is already frozen. Vendors can\u0027t use any newer types until 25Q2.",
      "parentUuid": "289f5e12_a1375739",
      "range": {
        "startLine": 204,
        "startChar": 0,
        "endLine": 204,
        "endChar": 19
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "32201908_a35431a9",
        "filename": "public/file.te",
        "patchSetId": 2
      },
      "lineNbr": 204,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2024-09-05T01:37:41Z",
      "side": 1,
      "message": "Do you know if there is another possible solution to allow a selinux rule in system partition to use nsfs, which is already defined as a vendor type for goldfish?",
      "parentUuid": "67da8455_26e3b12e",
      "range": {
        "startLine": 204,
        "startChar": 0,
        "endLine": 204,
        "endChar": 19
      },
      "revId": "7659cb890432f76243254fcef333b9379340f7ad",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}